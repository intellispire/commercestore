{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/js/frontend/gateways/paypal.js","webpack:///external \"jQuery\""],"names":["CS_PayPal","isMounted","init","document","getElementById","initButtons","jQuery","body","on","maybeRefreshPage","isPayPal","chosenGateway","length","attr","cs_scripts","default_gateway","e","data","total_plain","window","location","reload","setErrorHtml","container","context","errorHtml","cs_global_vars","checkout_error_anchor","errorWrapper","innerHTML","form","closest","querySelector","trigger","paypal","Buttons","getButtonArgs","render","dispatchEvent","CustomEvent","spinner","nonceEl","tokenEl","createFunc","csPayPalVars","intent","buttonArgs","onApprove","actions","formData","FormData","append","approvalAction","value","getAttribute","orderID","subscriptionID","fetch","ajaxurl","method","then","response","json","responseData","success","redirect_url","style","display","message","defaultError","retry","restart","onError","error","name","onCancel","nonces","Object","keys","forEach","key","setAttribute","orderData","paypal_order_id","nonce","token","timestamp","Promise","resolve","reject","gateway","ready","$","buyButtons","querySelectorAll","i","element","classList","contains","wrapper","errorNode","createElement","add","before","spinnerWrap","after"],"mappings":"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","file":"assets/js/paypal-checkout.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./assets/js/frontend/gateways/paypal.js\");\n","/* global csPayPalVars, cs_global_vars */\n\nvar CS_PayPal = {\n\tisMounted: false,\n\n\t/**\n\t * Initializes PayPal buttons and sets up some events.\n\t */\n\tinit: function() {\n\t\tif ( document.getElementById( 'cs-paypal-container' ) ) {\n\t\t\tthis.initButtons( '#cs-paypal-container', 'checkout' );\n\t\t}\n\n\t\tjQuery( document.body ).on( 'cs_discount_applied', this.maybeRefreshPage );\n\t\tjQuery( document.body ).on( 'cs_discount_removed', this.maybeRefreshPage );\n\t},\n\n\t/**\n\t * Determines whether or not the selected gateway is PayPal.\n\t * @returns {boolean}\n\t */\n\tisPayPal: function() {\n\t\tvar chosenGateway = false;\n\t\tif ( jQuery('select#cs-gateway, input.cs-gateway').length ) {\n\t\t\tchosenGateway = jQuery(\"meta[name='cs-chosen-gateway']\").attr('content');\n\t\t}\n\n\t\tif ( ! chosenGateway && cs_scripts.default_gateway ) {\n\t\t\tchosenGateway = cs_scripts.default_gateway;\n\t\t}\n\n\t\treturn 'paypal_commerce' === chosenGateway;\n\t},\n\n\t/**\n\t * Refreshes the page when adding or removing a 100% discount.\n\t *\n\t * @param e\n\t * @param {object} data\n\t */\n\tmaybeRefreshPage: function( e, data ) {\n\t\tif ( 0 === data.total_plain && CS_PayPal.isPayPal() ) {\n\t\t\twindow.location.reload();\n\t\t} else if ( ! CS_PayPal.isMounted && CS_PayPal.isPayPal() && data.total_plain > 0 ) {\n\t\t\twindow.location.reload();\n\t\t}\n\t},\n\n\t/**\n\t * Sets the error HTML, depending on the context.\n\t *\n\t * @param {string|HTMLElement} container\n\t * @param {string} context\n\t * @param {string} errorHtml\n\t */\n\tsetErrorHtml: function( container, context, errorHtml ) {\n\t\t// Format errors.\n\n\t\tif ( 'checkout' === context && 'undefined' !== typeof cs_global_vars && cs_global_vars.checkout_error_anchor ) {\n\t\t\t// Checkout errors.\n\t\t\tvar errorWrapper = document.getElementById( 'cs-paypal-errors-wrap' );\n\t\t\tif ( errorWrapper ) {\n\t\t\t\terrorWrapper.innerHTML = errorHtml;\n\t\t\t}\n\t\t} else if ( 'buy_now' === context ) {\n\t\t\t// Buy Now errors\n\t\t\tvar form = container.closest( '.cs_download_purchase_form' );\n\t\t\tvar errorWrapper = form ? form.querySelector( '.cs-paypal-checkout-buy-now-error-wrapper' ) : false;\n\n\t\t\tif ( errorWrapper ) {\n\t\t\t\terrorWrapper.innerHTML = errorHtml;\n\t\t\t}\n\t\t}\n\n\t\tjQuery( document.body ).trigger( 'cs_checkout_error', [ errorHtml ] );\n\t},\n\n\t/**\n\t * Initializes PayPal buttons\n\t *\n\t * @param {string|HTMLElement} container Element to render the buttons in.\n\t * @param {string} context   Context for the button. Either `checkout` or `buy_now`.\n\t */\n\tinitButtons: function( container, context ) {\n\t\tCS_PayPal.isMounted = true;\n\n\t\tpaypal.Buttons( CS_PayPal.getButtonArgs( container, context ) ).render( container );\n\n\t\tdocument.dispatchEvent( new CustomEvent( 'cs_paypal_buttons_mounted' ) );\n\t},\n\n\t/**\n\t * Retrieves the arguments used to build the PayPal button.\n\t *\n\t * @param {string|HTMLElement} container Element to render the buttons in.\n\t * @param {string} context   Context for the button. Either `checkout` or `buy_now`.\n\t */\n\tgetButtonArgs: function ( container, context ) {\n\t\tvar form = ( 'checkout' === context ) ? document.getElementById( 'cs_purchase_form' ) : container.closest( '.cs_download_purchase_form' );\n\t\tvar errorWrapper = ( 'checkout' === context ) ? form.querySelector( '#cs-paypal-errors-wrap' ) : form.querySelector( '.cs-paypal-checkout-buy-now-error-wrapper' );\n\t\tvar spinner = ( 'checkout' === context ) ? document.getElementById( 'cs-paypal-spinner' ) : form.querySelector( '.cs-paypal-spinner' );\n\t\tvar nonceEl = form.querySelector( 'input[name=\"cs_process_paypal_nonce\"]' );\n\t\tvar tokenEl = form.querySelector( 'input[name=\"cs-process-paypal-token\"]' );\n\t\tvar createFunc = ( 'subscription' === csPayPalVars.intent ) ? 'createSubscription' : 'createOrder';\n\n\t\tvar buttonArgs = {\n\t\t\tonApprove: function( data, actions ) {\n\t\t\t\tvar formData = new FormData();\n\t\t\t\tformData.append( 'action', csPayPalVars.approvalAction );\n\t\t\t\tformData.append( 'cs_process_paypal_nonce', nonceEl.value );\n\t\t\t\tformData.append( 'token', tokenEl.getAttribute('data-token') );\n\t\t\t\tformData.append( 'timestamp', tokenEl.getAttribute('data-timestamp' ) );\n\n\t\t\t\tif ( data.orderID ) {\n\t\t\t\t\tformData.append( 'paypal_order_id', data.orderID );\n\t\t\t\t}\n\t\t\t\tif ( data.subscriptionID ) {\n\t\t\t\t\tformData.append( 'paypal_subscription_id', data.subscriptionID );\n\t\t\t\t}\n\n\t\t\t\treturn fetch( cs_scripts.ajaxurl, {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tbody: formData\n\t\t\t\t} ).then( function( response ) {\n\t\t\t\t\treturn response.json();\n\t\t\t\t} ).then( function( responseData ) {\n\t\t\t\t\tif ( responseData.success && responseData.data.redirect_url ) {\n\t\t\t\t\t\twindow.location = responseData.data.redirect_url;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Hide spinner.\n\t\t\t\t\t\tspinner.style.display = 'none';\n\n\t\t\t\t\t\tvar errorHtml = responseData.data.message ? responseData.data.message : csPayPalVars.defaultError;\n\n\t\t\t\t\t\tCS_PayPal.setErrorHtml( container, context, errorHtml );\n\n\t\t\t\t\t\t// @link https://developer.paypal.com/docs/checkout/integration-features/funding-failure/\n\t\t\t\t\t\tif ( responseData.data.retry ) {\n\t\t\t\t\t\t\treturn actions.restart();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t},\n\t\t\tonError: function( error ) {\n\t\t\t\t// Hide spinner.\n\t\t\t\tspinner.style.display = 'none';\n\n\t\t\t\terror.name = '';\n\t\t\t\tCS_PayPal.setErrorHtml( container, context, error );\n\t\t\t},\n\t\t\tonCancel: function( data ) {\n\t\t\t\t// Hide spinner.\n\t\t\t\tspinner.style.display = 'none';\n\n\t\t\t\tconst formData = new FormData();\n\t\t\t\tformData.append( 'action', 'cs_cancel_paypal_order' );\n\t\t\t\treturn fetch( cs_scripts.ajaxurl, {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tbody: formData\n\t\t\t\t} ).then( function ( response ) {\n\t\t\t\t\treturn response.json();\n\t\t\t\t} ).then( function ( responseData ) {\n\t\t\t\t\tif ( responseData.success ) {\n\t\t\t\t\t\tconst nonces = responseData.data.nonces;\n\t\t\t\t\t\tObject.keys( nonces ).forEach( function ( key ) {\n\t\t\t\t\t\t\tdocument.getElementById( 'cs-gateway-' + key ).setAttribute( 'data-' + key + '-nonce', nonces[ key ] );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\n\t\t/*\n\t\t * Add style if we have any\n\t\t *\n\t\t * @link https://developer.paypal.com/docs/checkout/integration-features/customize-button/\n\t\t */\n\t\tif ( csPayPalVars.style ) {\n\t\t\tbuttonArgs.style = csPayPalVars.style;\n\t\t}\n\n\t\t/*\n\t\t * Add the `create` logic. This gets added to `createOrder` for one-time purchases\n\t\t * or `createSubscription` for recurring.\n\t\t */\n\t\tbuttonArgs[ createFunc ] = function ( data, actions ) {\n\t\t\t// Show spinner.\n\t\t\tspinner.style.display = 'block';\n\n\t\t\t// Clear errors at the start of each attempt.\n\t\t\tif ( errorWrapper ) {\n\t\t\t\terrorWrapper.innerHTML = '';\n\t\t\t}\n\n\t\t\t// Submit the form via AJAX.\n\t\t\treturn fetch( cs_scripts.ajaxurl, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: new FormData( form )\n\t\t\t} ).then( function( response ) {\n\t\t\t\treturn response.json();\n\t\t\t} ).then( function( orderData ) {\n\t\t\t\tif ( orderData.data && orderData.data.paypal_order_id ) {\n\n\t\t\t\t\t// Add the nonce to the form so we can validate it later.\n\t\t\t\t\tif ( orderData.data.nonce ) {\n\t\t\t\t\t\tnonceEl.value = orderData.data.nonce;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Add the token to the form so we can validate it later.\n\t\t\t\t\tif ( orderData.data.token ) {\n\t\t\t\t\t\tjQuery(tokenEl).attr( 'data-token', orderData.data.token );\n\t\t\t\t\t\tjQuery(tokenEl).attr( 'data-timestamp', orderData.data.timestamp );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn orderData.data.paypal_order_id;\n\t\t\t\t} else {\n\t\t\t\t\t// Error message.\n\t\t\t\t\tvar errorHtml = csPayPalVars.defaultError;\n\t\t\t\t\tif ( orderData.data && 'string' === typeof orderData.data ) {\n\t\t\t\t\t\terrorHtml = orderData.data;\n\t\t\t\t\t} else if ( 'string' === typeof orderData ) {\n\t\t\t\t\t\terrorHtml = orderData;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn new Promise( function( resolve, reject ) {\n\t\t\t\t\t\treject( errorHtml );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\n\t\treturn buttonArgs;\n\t}\n};\n\n/**\n * Initialize on checkout.\n */\njQuery( document.body ).on( 'cs_gateway_loaded', function( e, gateway ) {\n\tif ( 'paypal_commerce' !== gateway ) {\n\t\treturn;\n\t}\n\n\tCS_PayPal.init();\n} );\n\n/**\n * Initialize Buy Now buttons.\n */\njQuery( document ).ready( function( $ ) {\n\tvar buyButtons = document.querySelectorAll( '.cs-paypal-checkout-buy-now' );\n\tfor ( var i = 0; i < buyButtons.length; i++ ) {\n\t\tvar element = buyButtons[ i ];\n\t\t// Skip if \"Free Downloads\" is enabled for this download.\n\t\tif ( element.classList.contains( 'cs-free-download' ) ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tvar wrapper = element.closest( '.cs_purchase_submit_wrapper' );\n\t\tif ( ! wrapper ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Clear contents of the wrapper.\n\t\twrapper.innerHTML = '';\n\n\t\t// Add error container after the wrapper.\n\t\tvar errorNode = document.createElement( 'div' );\n\t\terrorNode.classList.add( 'cs-paypal-checkout-buy-now-error-wrapper' );\n\t\twrapper.before( errorNode );\n\n\t\t// Add spinner container.\n\t\tvar spinnerWrap = document.createElement( 'span' );\n\t\tspinnerWrap.classList.add( 'cs-paypal-spinner', 'cs-loading-ajax', 'cs-loading' );\n\t\tspinnerWrap.style.display = 'none';\n\t\twrapper.after( spinnerWrap );\n\n\t\t// Initialize button.\n\t\tCS_PayPal.initButtons( wrapper, 'buy_now' );\n\t}\n} );\n","module.exports = jQuery;"],"sourceRoot":""}